'use client';

import React, { useState } from 'react';
import { Upload, X, FileText, Image, Link, User, Calendar, Tag, ExternalLink, Video, Presentation } from 'lucide-react';
import { FloatingNav } from '@/components/ui/floating-navbar';
import { Home as HomeIcon } from 'lucide-react';

interface ProjectFormData {
  title: string;
  description: string;
  category: string;
  projectType: string;
  domain: string;
  class: string;
  section: string;
  batch: string;
  academicYear: string;
  teamNumber: string;
  teamLead: string;
  teamLeadNumber: string;
  referenceNo: string;
  technologies: string[];
  githubUrl: string;
  liveUrl: string;
  pptUrl: string;
  pptFile: File | null;
  abstractUrl: string;
  abstractFile: File | null;
  researchPaperUrl: string;
  researchPaperFile: File | null;
  workingVideoUrl: string;
  authorName: string;
  authorEmail: string;
  images: File[];
  documentation: File | null;
}

export default function UploadProject() {
  const [formData, setFormData] = useState<ProjectFormData>({
    title: '',
    description: '',
    category: '',
    projectType: '',
    domain: '',
    class: '',
    section: '',
    batch: '',
    academicYear: '',
    teamNumber: '',
    teamLead: '',
    teamLeadNumber: '',
    referenceNo: '',
    technologies: [],
    githubUrl: '',
    liveUrl: '',
    pptUrl: '',
    pptFile: null,
    abstractUrl: '',
    abstractFile: null,
    researchPaperUrl: '',
    researchPaperFile: null,
    workingVideoUrl: '',
    authorName: '',
    authorEmail: '',
    images: [],
    documentation: null,
  });

  const [techInput, setTechInput] = useState('');
  const [isSubmitting, setIsSubmitting] = useState(false);
  const [dragActive, setDragActive] = useState(false);
  const [isEditMode, setIsEditMode] = useState(false);
  const [currentStep, setCurrentStep] = useState(0);

  // Check for edit mode on component mount
  React.useEffect(() => {
    const urlParams = new URLSearchParams(window.location.search);
    const editRef = urlParams.get('edit');
    
    if (editRef) {
      loadProjectForEdit(editRef);
    }
  }, []);

  const loadProjectForEdit = (referenceNo: string) => {
    try {
      const existingProjects = JSON.parse(localStorage.getItem('microProjects') || '{}');
      const project = existingProjects[referenceNo];
      
      if (project) {
        setFormData({
          title: project.projectInfo.title || '',
          description: project.projectInfo.description || '',
          category: project.projectInfo.category || '',
          projectType: project.projectInfo.projectType || '',
          domain: project.projectInfo.domain || '',
          class: project.academicInfo.class || '',
          section: project.academicInfo.section || '',
          batch: project.academicInfo.batch || '',
          academicYear: project.academicInfo.academicYear || '',
          teamNumber: project.teamInfo.teamNumber || '',
          teamLead: project.teamInfo.teamLead || '',
          teamLeadNumber: project.teamInfo.teamLeadNumber || '',
          referenceNo: project.referenceNo || '',
          technologies: project.projectInfo.technologies || [],
          githubUrl: project.projectInfo.githubUrl || '',
          liveUrl: project.projectInfo.liveUrl || '',
          pptUrl: project.projectInfo.pptUrl || '',
          pptFile: null, // Can't reload files, but show if there was one
          abstractUrl: project.projectInfo.abstractUrl || '',
          abstractFile: null, // Can't reload files, but show if there was one
          researchPaperUrl: project.projectInfo.researchPaperUrl || '',
          researchPaperFile: null, // Can't reload files, but show if there was one
          workingVideoUrl: project.projectInfo.workingVideoUrl || '',
          authorName: project.teamInfo.authorName || '',
          authorEmail: project.teamInfo.authorEmail || '',
          images: [], // Can't reload files
          documentation: null, // Can't reload files
        });
        setIsEditMode(true);
        
        // Show info about previously uploaded files
        if (project.media?.pptFile || project.media?.abstractFile || project.media?.researchPaperFile) {
          const fileInfo = [];
          if (project.media.pptFile) fileInfo.push(`PPT: ${project.media.pptFile}`);
          if (project.media.abstractFile) fileInfo.push(`Abstract: ${project.media.abstractFile}`);
          if (project.media.researchPaperFile) fileInfo.push(`Research Paper: ${project.media.researchPaperFile}`);
          
          if (fileInfo.length > 0) {
            alert(`Project loaded for editing!\n\nPreviously uploaded files:\n${fileInfo.join('\n')}\n\nNote: You can upload new files to replace the existing ones.`);
          }
        }
      }
    } catch (error) {
      console.error('Error loading project for edit:', error);
    }
  };

  const navItems = [
    { name: 'Home', link: '/', icon: <HomeIcon className="w-4 h-4" /> },
  ];

  const projectTypes = [
    'Software',
    'Hardware',
    'Software + Hardware'
  ];

  const categories = [
    'Web Development',
    'Mobile App',
    'Data Science',
    'Machine Learning',
    'IoT',
    'Game Development',
    'Desktop Application',
    'API/Backend',
    'DevOps',
    'Other'
  ];

  const domains = [
    'Education',
    'Healthcare',
    'Travel & Tourism',
    'E-commerce',
    'Finance & Banking',
    'Entertainment',
    'Social Media',
    'Food & Restaurant',
    'Transportation',
    'Real Estate',
    'Agriculture',
    'Sports & Fitness',
    'Gaming',
    'Environment',
    'Security',
    'Communication',
    'Productivity',
    'Art & Design',
    'Music & Audio',
    'News & Media',
    'Other'
  ];

  const academicYears = [
    '2026-2027',
    '2025-2026',
    '2024-2025',
    '2023-2024',
    '2022-2023',
    '2021-2022'
  ];

  const classes = [
    'CSE - Computer Science Engineering',
    'CSD - Computer Science & Design',
    'CSM - Computer Science & Mathematics',
    'ECE - Electronics & Communication',
    'AERO - Aerospace Engineering',
    'MECH - Mechanical Engineering',
    'EEE - Electrical & Electronics Engineering'
  ];

  const batches = [
    'Batch 1',
    'Batch 2'
  ];

  // Dynamic sections based on class (branch)
  const getSectionsForClass = (className: string): string[] => {
    if (!className) return [];
    
    const classCode = className.split(' - ')[0]; // Extract just the code part (CSE, CSD, etc.)
    
    switch (classCode) {
      case 'CSE':
        return ['A', 'B', 'C', 'D', 'E', 'F', 'G'];
      case 'CSD':
      case 'CSM':
        return ['A', 'B', 'C'];
      case 'ECE':
        return ['A', 'B'];
      case 'AERO':
      case 'MECH':
      case 'EEE':
        return ['A'];
      default:
        return ['A'];
    }
  };

  const availableSections = getSectionsForClass(formData.class);

  // Auto-generate reference number
  const generateReferenceNumber = () => {
    if (!formData.academicYear || !formData.class || !formData.section || !formData.projectType || !formData.batch || !formData.teamNumber) {
      return '';
    }

    // Extract academic year (e.g., "2024-2025" -> "2025-26")
    const yearParts = formData.academicYear.split('-');
    const shortYear = yearParts[1] ? `${yearParts[1]}-${(parseInt(yearParts[1]) + 1).toString().slice(-2)}` : '';

    // Extract class code (e.g., "CSE - Computer Science Engineering" -> "CSE")
    const classCode = formData.class.split(' - ')[0];

    // Extract section (e.g., "Section A" -> "A" or just "A" -> "A")
    const sectionCode = formData.section.replace('Section ', '');

    // Extract project type code (Software -> S, Hardware -> H, Software + Hardware -> SH)
    let projectTypeCode = '';
    if (formData.projectType === 'Software') {
      projectTypeCode = 'S';
    } else if (formData.projectType === 'Hardware') {
      projectTypeCode = 'H';
    } else if (formData.projectType === 'Software + Hardware') {
      projectTypeCode = 'SH';
    }

    // Extract batch code (e.g., "Batch 1" -> "B1")
    const batchCode = formData.batch.replace('Batch ', 'B');

    // Format team number with leading zeros (e.g., "1" -> "001")
    const teamNumberFormatted = formData.teamNumber.padStart(3, '0');

    return `MP${shortYear}${classCode}-${sectionCode}${projectTypeCode}${batchCode}${teamNumberFormatted}`;
  };

  // Auto-update reference number when dependencies change
  React.useEffect(() => {
    const autoRef = generateReferenceNumber();
    if (autoRef && autoRef !== formData.referenceNo) {
      setFormData(prev => ({
        ...prev,
        referenceNo: autoRef
      }));
    }
  }, [formData.academicYear, formData.class, formData.section, formData.projectType, formData.batch, formData.teamNumber]);

  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement | HTMLSelectElement>) => {
    const { name, value } = e.target;
    
    // If class changes, reset section
    if (name === 'class') {
      setFormData(prev => ({
        ...prev,
        [name]: value,
        section: '' // Reset section when class changes
      }));
    } else {
      setFormData(prev => ({
        ...prev,
        [name]: value
      }));
    }
  };

  const handleTechAdd = (e: React.KeyboardEvent<HTMLInputElement>) => {
    if (e.key === 'Enter' && techInput.trim()) {
      e.preventDefault();
      if (!formData.technologies.includes(techInput.trim())) {
        setFormData(prev => ({
          ...prev,
          technologies: [...prev.technologies, techInput.trim()]
        }));
      }
      setTechInput('');
    }
  };

  const removeTech = (tech: string) => {
    setFormData(prev => ({
      ...prev,
      technologies: prev.technologies.filter(t => t !== tech)
    }));
  };

  const handleImageUpload = (files: FileList | null) => {
    if (files) {
      const newImages = Array.from(files).filter(file => 
        file.type.startsWith('image/') && file.size <= 5 * 1024 * 1024 // 5MB limit
      );
      setFormData(prev => ({
        ...prev,
        images: [...prev.images, ...newImages].slice(0, 5) // Max 5 images
      }));
    }
  };

  const handleDocumentUpload = (file: File | null) => {
    if (file && (file.type === 'application/pdf' || file.type.startsWith('text/'))) {
      setFormData(prev => ({
        ...prev,
        documentation: file
      }));
    }
  };

  const handlePPTUpload = (file: File | null) => {
    if (file && (file.type === 'application/pdf' || 
                 file.type === 'application/vnd.ms-powerpoint' || 
                 file.type === 'application/vnd.openxmlformats-officedocument.presentationml.presentation')) {
      setFormData(prev => ({
        ...prev,
        pptFile: file
      }));
    }
  };

  const handleAbstractUpload = (file: File | null) => {
    if (file && (file.type === 'application/pdf' || 
                 file.type === 'application/msword' || 
                 file.type === 'application/vnd.openxmlformats-officedocument.wordprocessingml.document' ||
                 file.type.startsWith('text/'))) {
      setFormData(prev => ({
        ...prev,
        abstractFile: file
      }));
    }
  };

  const handleResearchPaperUpload = (file: File | null) => {
    if (file && (file.type === 'application/pdf' || 
                 file.type === 'application/msword' || 
                 file.type === 'application/vnd.openxmlformats-officedocument.wordprocessingml.document')) {
      setFormData(prev => ({
        ...prev,
        researchPaperFile: file
      }));
    }
  };

  const handleDrag = (e: React.DragEvent) => {
    e.preventDefault();
    e.stopPropagation();
    if (e.type === 'dragenter' || e.type === 'dragover') {
      setDragActive(true);
    } else if (e.type === 'dragleave') {
      setDragActive(false);
    }
  };

  const handleDrop = (e: React.DragEvent) => {
    e.preventDefault();
    e.stopPropagation();
    setDragActive(false);
    
    if (e.dataTransfer.files && e.dataTransfer.files[0]) {
      handleImageUpload(e.dataTransfer.files);
    }
  };

  const removeImage = (index: number) => {
    setFormData(prev => ({
      ...prev,
      images: prev.images.filter((_, i) => i !== index)
    }));
  };

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    setIsSubmitting(true);

    try {
      // Validate that reference number is generated
      if (!formData.referenceNo) {
        alert('Please fill all required fields to generate a reference number.');
        setIsSubmitting(false);
        return;
      }

      // Create project data object with reference number as identifier
      const projectData = {
        referenceNo: formData.referenceNo,
        projectInfo: {
          title: formData.title,
          description: formData.description,
          category: formData.category,
          projectType: formData.projectType,
          domain: formData.domain,
          technologies: formData.technologies,
          githubUrl: formData.githubUrl,
          liveUrl: formData.liveUrl,
          pptUrl: formData.pptUrl,
          abstractUrl: formData.abstractUrl,
          researchPaperUrl: formData.researchPaperUrl,
          workingVideoUrl: formData.workingVideoUrl,
        },
        academicInfo: {
          academicYear: formData.academicYear,
          class: formData.class,
          section: formData.section,
          batch: formData.batch,
        },
        teamInfo: {
          teamNumber: formData.teamNumber,
          teamLead: formData.teamLead,
          teamLeadNumber: formData.teamLeadNumber,
          authorName: formData.authorName,
          authorEmail: formData.authorEmail,
        },
        media: {
          images: formData.images.map(img => img.name), // Store image names
          documentation: formData.documentation?.name || null,
          pptFile: formData.pptFile?.name || null,
          abstractFile: formData.abstractFile?.name || null,
          researchPaperFile: formData.researchPaperFile?.name || null,
        },
        metadata: {
          createdAt: new Date().toISOString(),
          status: 'submitted',
          submissionId: formData.referenceNo, // Use reference number as submission ID
        }
      };

      // In a real application, you would save this to a database or file system
      // For demo purposes, we'll save to localStorage with reference number as key
      const existingProjects = JSON.parse(localStorage.getItem('microProjects') || '{}');
      existingProjects[formData.referenceNo] = projectData;
      localStorage.setItem('microProjects', JSON.stringify(existingProjects));

      // Also save to a list for easy retrieval
      const projectsList = JSON.parse(localStorage.getItem('microProjectsList') || '[]');
      if (!projectsList.includes(formData.referenceNo)) {
        projectsList.push(formData.referenceNo);
        localStorage.setItem('microProjectsList', JSON.stringify(projectsList));
      }

      console.log('Project saved with reference:', formData.referenceNo);
      console.log('Project data:', projectData);

      alert(`Project uploaded successfully!\nReference Number: ${formData.referenceNo}\n\nYour project has been saved with this reference number.`);
      
      // Reset form
      setFormData({
        title: '',
        description: '',
        category: '',
        projectType: '',
        domain: '',
        class: '',
        section: '',
        batch: '',
        academicYear: '',
        teamNumber: '',
        teamLead: '',
        teamLeadNumber: '',
        referenceNo: '',
        technologies: [],
        githubUrl: '',
        liveUrl: '',
        pptUrl: '',
        pptFile: null,
        abstractUrl: '',
        abstractFile: null,
        researchPaperUrl: '',
        researchPaperFile: null,
        workingVideoUrl: '',
        authorName: '',
        authorEmail: '',
        images: [],
        documentation: null,
      });
      setTechInput('');
      
    } catch (error) {
      console.error('Save error:', error);
      alert('Failed to save project. Please try again.');
    } finally {
      setIsSubmitting(false);
    }
  };

  return (
    <div className="min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100">
      <FloatingNav navItems={navItems} />
      
      <div className="container mx-auto px-4 py-20">
        <div className="max-w-4xl mx-auto">
          <div className="text-center mb-8">
            <h1 className="text-4xl font-bold text-gray-900 mb-4">
              {isEditMode ? 'Edit Your Project' : 'Upload Your Project'}
            </h1>
            <p className="text-lg text-gray-600">
              {isEditMode ? 'Update your project details' : 'Share your amazing work with the community'}
            </p>
            <div className="mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg">
              <p className="text-sm text-blue-700">
                <strong>{isEditMode ? 'Edit Mode:' : 'Demo Mode:'}</strong> Projects are saved locally with their reference numbers.
              </p>
            </div>
          </div>

          <form onSubmit={handleSubmit} className="bg-white rounded-2xl shadow-xl p-8 space-y-8">
            {/* Basic Information */}
            <div className="space-y-6">
              <h2 className="text-2xl font-semibold text-gray-800 flex items-center gap-2">
                <FileText className="w-6 h-6" />
                Project Information
              </h2>
              
              <div className="grid md:grid-cols-2 gap-6">
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">
                    Project Title *
                  </label>
                  <input
                    type="text"
                    name="title"
                    value={formData.title}
                    onChange={handleInputChange}
                    required
                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                    placeholder="Enter your project title"
                  />
                </div>

                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">
                    Reference No (Auto-generated) *
                  </label>
                  <div className="flex gap-2">
                    <input
                      type="text"
                      name="referenceNo"
                      value={formData.referenceNo}
                      readOnly
                      className="flex-1 px-4 py-3 border border-gray-300 rounded-lg bg-gray-50 text-gray-700 cursor-not-allowed"
                      placeholder="Fill required fields to generate"
                    />
                    <button
                      type="button"
                      onClick={() => {
                        const newRef = generateReferenceNumber();
                        if (newRef) {
                          setFormData(prev => ({ ...prev, referenceNo: newRef }));
                        }
                      }}
                      disabled={!generateReferenceNumber()}
                      className="px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors"
                      title="Regenerate reference number"
                    >
                      üîÑ
                    </button>
                  </div>
                  <p className="text-xs text-gray-500 mt-1">
                    Format: MP[Year][Branch]-[Section][Type][Batch][TeamNo]
                  </p>
                  {formData.referenceNo && (
                    <p className="text-xs text-green-600 mt-1">
                      Generated: {formData.referenceNo}
                    </p>
                  )}
                </div>
              </div>

              <div className="grid md:grid-cols-3 gap-6">
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">
                    Category *
                  </label>
                  <select
                    name="category"
                    value={formData.category}
                    onChange={handleInputChange}
                    required
                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                  >
                    <option value="">Select a category</option>
                    {categories.map(cat => (
                      <option key={cat} value={cat}>{cat}</option>
                    ))}
                  </select>
                </div>

                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">
                    Project Type *
                  </label>
                  <select
                    name="projectType"
                    value={formData.projectType}
                    onChange={handleInputChange}
                    required
                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                  >
                    <option value="">Select project type</option>
                    {projectTypes.map(type => (
                      <option key={type} value={type}>{type}</option>
                    ))}
                  </select>
                </div>

                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">
                    Project Domain *
                  </label>
                  <select
                    name="domain"
                    value={formData.domain}
                    onChange={handleInputChange}
                    required
                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                  >
                    <option value="">Select project domain</option>
                    {domains.map(domain => (
                      <option key={domain} value={domain}>{domain}</option>
                    ))}
                  </select>
                </div>
              </div>

              <div>
                <label className="block text-sm font-medium text-gray-700 mb-2">
                  Description *
                </label>
                <textarea
                  name="description"
                  value={formData.description}
                  onChange={handleInputChange}
                  required
                  rows={4}
                  className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                  placeholder="Describe your project, its features, and what makes it special..."
                />
              </div>

              <div>
                <label className="block text-sm font-medium text-gray-700 mb-2">
                  Technologies Used
                </label>
                <input
                  type="text"
                  value={techInput}
                  onChange={(e) => setTechInput(e.target.value)}
                  onKeyDown={handleTechAdd}
                  className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                  placeholder="Type a technology and press Enter (e.g., React, Node.js, Python)"
                />
                <div className="flex flex-wrap gap-2 mt-3">
                  {formData.technologies.map((tech, index) => (
                    <span
                      key={index}
                      className="inline-flex items-center gap-1 px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm"
                    >
                      <Tag className="w-3 h-3" />
                      {tech}
                      <button
                        type="button"
                        onClick={() => removeTech(tech)}
                        className="ml-1 hover:text-blue-600"
                      >
                        <X className="w-3 h-3" />
                      </button>
                    </span>
                  ))}
                </div>
              </div>
            </div>

            {/* Academic Information */}
            <div className="space-y-6">
              <h2 className="text-2xl font-semibold text-gray-800 flex items-center gap-2">
                <Calendar className="w-6 h-6" />
                Academic Information
              </h2>
              
              <div className="grid md:grid-cols-2 lg:grid-cols-4 gap-6">
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">
                    Academic Year *
                  </label>
                  <select
                    name="academicYear"
                    value={formData.academicYear}
                    onChange={handleInputChange}
                    required
                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                  >
                    <option value="">Select academic year</option>
                    {academicYears.map(year => (
                      <option key={year} value={year}>{year}</option>
                    ))}
                  </select>
                </div>

                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">
                    Class (Branch) *
                  </label>
                  <select
                    name="class"
                    value={formData.class}
                    onChange={handleInputChange}
                    required
                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                  >
                    <option value="">Select branch</option>
                    {classes.map(cls => (
                      <option key={cls} value={cls}>{cls}</option>
                    ))}
                  </select>
                </div>

                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">
                    Section *
                  </label>
                  <select
                    name="section"
                    value={formData.section}
                    onChange={handleInputChange}
                    required
                    disabled={!formData.class || availableSections.length === 0}
                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed"
                  >
                    <option value="">
                      {!formData.class ? 'Select branch first' : 'Select section'}
                    </option>
                    {availableSections.map(section => (
                      <option key={section} value={section}>Section {section}</option>
                    ))}
                  </select>
                  {formData.class && availableSections.length > 0 && (
                    <p className="text-xs text-gray-500 mt-1">
                      Available sections for {formData.class.split(' - ')[0]}: {availableSections.join(', ')}
                    </p>
                  )}
                  {formData.class && availableSections.length === 0 && (
                    <p className="text-xs text-red-500 mt-1">
                      No sections available for selected branch
                    </p>
                  )}
                </div>

                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">
                    Batch *
                  </label>
                  <select
                    name="batch"
                    value={formData.batch}
                    onChange={handleInputChange}
                    required
                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                  >
                    <option value="">Select batch</option>
                    {batches.map(batch => (
                      <option key={batch} value={batch}>{batch}</option>
                    ))}
                  </select>
                </div>
              </div>
            </div>

            {/* Team Information */}
            <div className="space-y-6">
              <h2 className="text-2xl font-semibold text-gray-800 flex items-center gap-2">
                <User className="w-6 h-6" />
                Team Information
              </h2>
              
              <div className="grid md:grid-cols-2 gap-6">
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">
                    Team Number *
                  </label>
                  <input
                    type="text"
                    name="teamNumber"
                    value={formData.teamNumber}
                    onChange={handleInputChange}
                    required
                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                    placeholder="Enter team number"
                  />
                </div>

                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">
                    Team Lead *
                  </label>
                  <input
                    type="text"
                    name="teamLead"
                    value={formData.teamLead}
                    onChange={handleInputChange}
                    required
                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                    placeholder="Enter team lead name"
                  />
                </div>

                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">
                    Team Lead Contact *
                  </label>
                  <input
                    type="tel"
                    name="teamLeadNumber"
                    value={formData.teamLeadNumber}
                    onChange={handleInputChange}
                    required
                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                    placeholder="Enter team lead phone number"
                  />
                </div>

                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">
                    Your Name *
                  </label>
                  <input
                    type="text"
                    name="authorName"
                    value={formData.authorName}
                    onChange={handleInputChange}
                    required
                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                    placeholder="Enter your full name"
                  />
                </div>

                <div className="md:col-span-2">
                  <label className="block text-sm font-medium text-gray-700 mb-2">
                    Email Address *
                  </label>
                  <input
                    type="email"
                    name="authorEmail"
                    value={formData.authorEmail}
                    onChange={handleInputChange}
                    required
                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                    placeholder="your.email@example.com"
                  />
                </div>
              </div>
            </div>

            {/* Links */}
            <div className="space-y-6">
              <h2 className="text-2xl font-semibold text-gray-800 flex items-center gap-2">
                <Link className="w-6 h-6" />
                Project Links & Resources
              </h2>
              
              {/* Stepper Navigation */}
              <div className="bg-white rounded-xl p-6 shadow-sm border border-gray-100">
                <div className="flex items-center justify-between mb-8">
                  {['Basic Links', 'Documents', 'Media'].map((step, index) => (
                    <div key={step} className="flex items-center flex-1">
                      <div className="flex items-center">
                        <div
                          className={`w-12 h-12 rounded-full flex items-center justify-center text-sm font-semibold transition-all duration-300 cursor-pointer ${
                            index <= currentStep
                              ? 'bg-gradient-to-r from-blue-500 to-blue-600 text-white shadow-lg transform scale-105'
                              : 'bg-gray-100 text-gray-500 hover:bg-gray-200'
                          }`}
                          onClick={() => setCurrentStep(index)}
                        >
                          {index + 1}
                        </div>
                        <div className="ml-4">
                          <span
                            className={`block text-sm font-semibold cursor-pointer transition-colors ${
                              index <= currentStep ? 'text-blue-600' : 'text-gray-500'
                            }`}
                            onClick={() => setCurrentStep(index)}
                          >
                            {step}
                          </span>
                          <span className="text-xs text-gray-400">
                            {index === 0 && 'URLs & Links'}
                            {index === 1 && 'Files & Papers'}
                            {index === 2 && 'Images & Docs'}
                          </span>
                        </div>
                      </div>
                      {index < 2 && (
                        <div className="flex-1 mx-6">
                          <div
                            className={`h-1 rounded-full transition-all duration-500 ${
                              index < currentStep 
                                ? 'bg-gradient-to-r from-blue-500 to-blue-600' 
                                : 'bg-gray-200'
                            }`}
                          />
                        </div>
                      )}
                    </div>
                  ))}
                </div>

              {/* Step Content */}
              <div className="min-h-[500px]">
                {/* Step 0: Basic Links */}
                {currentStep === 0 && (
                  <div className="space-y-6">
                    <div className="text-center mb-8">
                      <h3 className="text-xl font-semibold text-gray-800 mb-2">Project Links</h3>
                      <p className="text-gray-600">Add your project's online presence and demo links</p>
                    </div>
                    
                    <div className="grid gap-6">
                      <div className="bg-gradient-to-r from-gray-50 to-blue-50 rounded-xl p-6 border border-gray-200">
                        <div className="flex items-center gap-3 mb-4">
                          <div className="w-10 h-10 bg-gray-900 rounded-lg flex items-center justify-center">
                            <svg className="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 24 24">
                              <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                            </svg>
                          </div>
                          <div>
                            <label className="block text-lg font-semibold text-gray-800">GitHub Repository</label>
                            <p className="text-sm text-gray-600">Link to your source code</p>
                          </div>
                        </div>
                        <input
                          type="url"
                          name="githubUrl"
                          value={formData.githubUrl}
                          onChange={handleInputChange}
                          className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white"
                          placeholder="https://github.com/username/repository"
                        />
                      </div>

                      <div className="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-6 border border-blue-200">
                        <div className="flex items-center gap-3 mb-4">
                          <div className="w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center">
                            <ExternalLink className="w-5 h-5 text-white" />
                          </div>
                          <div>
                            <label className="block text-lg font-semibold text-gray-800">Live Demo URL</label>
                            <p className="text-sm text-gray-600">Working demonstration of your project</p>
                          </div>
                        </div>
                        <input
                          type="url"
                          name="liveUrl"
                          value={formData.liveUrl}
                          onChange={handleInputChange}
                          className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white"
                          placeholder="https://your-project-demo.com"
                        />
                      </div>

                      <div className="bg-gradient-to-r from-red-50 to-pink-50 rounded-xl p-6 border border-red-200">
                        <div className="flex items-center gap-3 mb-4">
                          <div className="w-10 h-10 bg-red-600 rounded-lg flex items-center justify-center">
                            <Video className="w-5 h-5 text-white" />
                          </div>
                          <div>
                            <label className="block text-lg font-semibold text-gray-800">Working Video URL</label>
                            <p className="text-sm text-gray-600">Video demonstration or walkthrough</p>
                          </div>
                        </div>
                        <input
                          type="url"
                          name="workingVideoUrl"
                          value={formData.workingVideoUrl}
                          onChange={handleInputChange}
                          className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white"
                          placeholder="https://youtube.com/watch?v=... or https://vimeo.com/..."
                        />
                      </div>
                    </div>
                  </div>
                )}

                {/* Step 1: Documents */}
                {currentStep === 1 && (
                  <div className="space-y-6">
                    <h3 className="text-lg font-semibold text-gray-800 mb-4">Document Uploads</h3>
                    
                    {/* PPT Upload */}
                    <div className="bg-white rounded-lg p-6 border border-gray-200">
                      <div className="flex items-center gap-2 mb-4">
                        <span className="text-2xl">üìä</span>
                        <label className="text-lg font-medium text-gray-700">
                          Presentation (PPT/PDF)
                        </label>
                      </div>
                      
                      <div className="grid md:grid-cols-2 gap-4">
                        {/* URL Input */}
                        <div>
                          <label className="block text-sm font-medium text-gray-600 mb-2">
                            üîó Add Link
                          </label>
                          <input
                            type="url"
                            name="pptUrl"
                            value={formData.pptUrl}
                            onChange={handleInputChange}
                            className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                            placeholder="https://drive.google.com/... or https://slideshare.net/..."
                          />
                        </div>
                        
                        {/* File Upload */}
                        <div>
                          <label className="block text-sm font-medium text-gray-600 mb-2">
                            üìÅ Upload File
                          </label>
                          <div className="border-2 border-dashed border-gray-300 rounded-lg p-4 text-center hover:border-blue-400 transition-colors">
                            <input
                              type="file"
                              accept=".pdf,.ppt,.pptx"
                              onChange={(e) => handlePPTUpload(e.target.files?.[0] || null)}
                              className="hidden"
                              id="ppt-upload"
                            />
                            <label htmlFor="ppt-upload" className="cursor-pointer">
                              <Upload className="w-6 h-6 mx-auto mb-2 text-gray-400" />
                              <p className="text-sm text-gray-600">Click to upload</p>
                              <p className="text-xs text-gray-500">.ppt, .pptx, .pdf</p>
                            </label>
                          </div>
                          {formData.pptFile && (
                            <div className="flex items-center gap-2 p-2 bg-green-50 border border-green-200 rounded-lg mt-2">
                              <FileText className="w-4 h-4 text-green-600" />
                              <span className="text-sm text-green-700">{formData.pptFile.name}</span>
                            </div>
                          )}
                        </div>
                      </div>
                    </div>

                    {/* Abstract Upload */}
                    <div className="bg-white rounded-lg p-6 border border-gray-200">
                      <div className="flex items-center gap-2 mb-4">
                        <span className="text-2xl">üìÑ</span>
                        <label className="text-lg font-medium text-gray-700">
                          Abstract Document
                        </label>
                      </div>
                      
                      <div className="grid md:grid-cols-2 gap-4">
                        {/* URL Input */}
                        <div>
                          <label className="block text-sm font-medium text-gray-600 mb-2">
                            üîó Add Link
                          </label>
                          <input
                            type="url"
                            name="abstractUrl"
                            value={formData.abstractUrl}
                            onChange={handleInputChange}
                            className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                            placeholder="https://drive.google.com/... or document link"
                          />
                        </div>
                        
                        {/* File Upload */}
                        <div>
                          <label className="block text-sm font-medium text-gray-600 mb-2">
                            ÔøΩ Upload File
                          </label>
                          <div className="border-2 border-dashed border-gray-300 rounded-lg p-4 text-center hover:border-blue-400 transition-colors">
                            <input
                              type="file"
                              accept=".pdf,.doc,.docx,.txt"
                              onChange={(e) => handleAbstractUpload(e.target.files?.[0] || null)}
                              className="hidden"
                              id="abstract-upload"
                            />
                            <label htmlFor="abstract-upload" className="cursor-pointer">
                              <Upload className="w-6 h-6 mx-auto mb-2 text-gray-400" />
                              <p className="text-sm text-gray-600">Click to upload</p>
                              <p className="text-xs text-gray-500">.pdf, .doc, .docx, .txt</p>
                            </label>
                          </div>
                          {formData.abstractFile && (
                            <div className="flex items-center gap-2 p-2 bg-green-50 border border-green-200 rounded-lg mt-2">
                              <FileText className="w-4 h-4 text-green-600" />
                              <span className="text-sm text-green-700">{formData.abstractFile.name}</span>
                            </div>
                          )}
                        </div>
                      </div>
                    </div>

                    {/* Research Paper Upload */}
                    <div className="bg-white rounded-lg p-6 border border-gray-200">
                      <div className="flex items-center gap-2 mb-4">
                        <span className="text-2xl">üî¨</span>
                        <label className="text-lg font-medium text-gray-700">
                          Research Paper
                        </label>
                      </div>
                      
                      <div className="grid md:grid-cols-2 gap-4">
                        {/* URL Input */}
                        <div>
                          <label className="block text-sm font-medium text-gray-600 mb-2">
                            üîó Add Link
                          </label>
                          <input
                            type="url"
                            name="researchPaperUrl"
                            value={formData.researchPaperUrl}
                            onChange={handleInputChange}
                            className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                            placeholder="https://arxiv.org/... or research paper link"
                          />
                        </div>
                        
                        {/* File Upload */}
                        <div>
                          <label className="block text-sm font-medium text-gray-600 mb-2">
                            üìÅ Upload File
                          </label>
                          <div className="border-2 border-dashed border-gray-300 rounded-lg p-4 text-center hover:border-blue-400 transition-colors">
                            <input
                              type="file"
                              accept=".pdf,.doc,.docx"
                              onChange={(e) => handleResearchPaperUpload(e.target.files?.[0] || null)}
                              className="hidden"
                              id="research-upload"
                            />
                            <label htmlFor="research-upload" className="cursor-pointer">
                              <Upload className="w-6 h-6 mx-auto mb-2 text-gray-400" />
                              <p className="text-sm text-gray-600">Click to upload</p>
                              <p className="text-xs text-gray-500">.pdf, .doc, .docx</p>
                            </label>
                          </div>
                          {formData.researchPaperFile && (
                            <div className="flex items-center gap-2 p-2 bg-green-50 border border-green-200 rounded-lg mt-2">
                              <FileText className="w-4 h-4 text-green-600" />
                              <span className="text-sm text-green-700">{formData.researchPaperFile.name}</span>
                            </div>
                          )}
                        </div>
                      </div>
                    </div>
                  </div>
                )}

                {/* Step 2: Media */}
                {currentStep === 2 && (
                  <div className="space-y-6">
                    <h3 className="text-lg font-semibold text-gray-800 mb-4">Project Media</h3>
                    
                    {/* Image Upload */}
                    <div className="bg-white rounded-lg p-4 border border-gray-200">
                      <label className="block text-sm font-medium text-gray-700 mb-3">
                        üñºÔ∏è Project Images (Max 5, 5MB each)
                      </label>
                      <div
                        className={`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${
                          dragActive ? 'border-blue-500 bg-blue-50' : 'border-gray-300 hover:border-blue-400'
                        }`}
                        onDragEnter={handleDrag}
                        onDragLeave={handleDrag}
                        onDragOver={handleDrag}
                        onDrop={handleDrop}
                      >
                        <Upload className="w-12 h-12 text-gray-400 mx-auto mb-4" />
                        <p className="text-gray-600 mb-2">Drag and drop images here, or</p>
                        <input
                          type="file"
                          multiple
                          accept="image/*"
                          onChange={(e) => handleImageUpload(e.target.files)}
                          className="hidden"
                          id="image-upload"
                        />
                        <label
                          htmlFor="image-upload"
                          className="inline-block px-6 py-3 bg-blue-500 text-white rounded-lg cursor-pointer hover:bg-blue-600 transition-colors"
                        >
                          Choose Images
                        </label>
                      </div>
                      
                      {formData.images.length > 0 && (
                        <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4 mt-4">
                          {formData.images.map((image, index) => (
                            <div key={index} className="relative">
                              <img
                                src={URL.createObjectURL(image)}
                                alt={`Preview ${index + 1}`}
                                className="w-full h-24 object-cover rounded-lg"
                              />
                              <button
                                type="button"
                                onClick={() => removeImage(index)}
                                className="absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 hover:bg-red-600"
                              >
                                <X className="w-3 h-3" />
                              </button>
                            </div>
                          ))}
                        </div>
                      )}
                    </div>

                    {/* Documentation Upload */}
                    <div className="bg-white rounded-lg p-4 border border-gray-200">
                      <label className="block text-sm font-medium text-gray-700 mb-3">
                        üìã Additional Documentation (Optional)
                      </label>
                      <input
                        type="file"
                        accept=".pdf,.txt,.md"
                        onChange={(e) => handleDocumentUpload(e.target.files?.[0] || null)}
                        className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                      />
                      {formData.documentation && (
                        <div className="flex items-center gap-2 p-2 bg-green-50 border border-green-200 rounded-lg mt-3">
                          <FileText className="w-4 h-4 text-green-600" />
                          <span className="text-sm text-green-700">{formData.documentation.name}</span>
                        </div>
                      )}
                    </div>
                  </div>
                )}

                {/* Navigation Buttons */}
                <div className="flex justify-between items-center mt-8 pt-6 border-t border-gray-200">
                  <button
                    type="button"
                    onClick={() => setCurrentStep(Math.max(0, currentStep - 1))}
                    disabled={currentStep === 0}
                    className="flex items-center gap-2 px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-300 font-medium"
                  >
                    ‚Üê Previous
                  </button>
                  
                  <div className="flex items-center gap-2">
                    <span className="text-sm text-gray-500">Step {currentStep + 1} of 3</span>
                    <div className="flex gap-1">
                      {[0, 1, 2].map((step) => (
                        <div
                          key={step}
                          className={`w-2 h-2 rounded-full transition-colors ${
                            step <= currentStep ? 'bg-blue-600' : 'bg-gray-300'
                          }`}
                        />
                      ))}
                    </div>
                  </div>
                  
                  <button
                    type="button"
                    onClick={() => setCurrentStep(Math.min(2, currentStep + 1))}
                    disabled={currentStep === 2}
                    className="flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-300 font-medium"
                  >
                    Next ‚Üí
                  </button>
                </div>
              </div>
            </div>

            {/* Submit Button */}
            <div className="pt-6">
              <button
                type="submit"
                disabled={isSubmitting}
                className="w-full bg-blue-600 text-white py-4 px-6 rounded-lg font-semibold text-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center gap-2"
              >
                {isSubmitting ? (
                  <>
                    <div className="animate-spin rounded-full h-5 w-5 border-b-2 border-white"></div>
                    {isEditMode ? 'Updating...' : 'Uploading...'}
                  </>
                ) : (
                  <>
                    <Upload className="w-5 h-5" />
                    {isEditMode ? 'Update Project' : 'Upload Project'}
                  </>
                )}
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  );
}